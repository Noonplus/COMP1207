## ตัวอย่างการพัฒนาโปรแกรมพื้นฐานทางธุรกิจ (ต่อ)
การวิเคราะห์และประเมินโครงการเพื่อการลงทุนเป็นสิ่งที่ผู้บริหารให้ความสำคัญและต้องพิจารณาอย่างรอบคอบในเรื่องของผลตอบแทนและความเสี่ยงของการลงทุน เทคนิคที่ใช้ในการประเมินภาพรวมของโครงการ โดยเฉพาะการตัดสินใจด้านการเงินสามารถใช้เครื่องมือในการวิเคราะห์และตัดสินใจได้ ดังนี้ 

### การตัดสินใจในการลงทุน-วิธีพิจารณาจากมูลค่าปัจจุบันสุทธิ
มูลค่าปัจจุบันสุทธิ (Net Present Value: NPV) เป็นวิธีการประเมินผลต่างของมูลค่าผลตอบแทนปัจจุบันกับผลตอบแทนที่คาดว่าจะได้รับในอนาคตตามอัตราผลตอบแทนที่ต้องการ (เฉลิมขวัญ ครุธบุญยงค์. 2556) โดยใช้วิธีคำนวณลดทอนกระแสเงินสดสุทธิให้กลับมาเป็นมูลค่าปัจจุบัน (Present Value) จากนั้นจึงคำนวณผลรวมออกมาเป็นมูลค่าปัจจุบันสุทธิเพื่อใช้ในการตัดสินใจลงทุน ตัวอย่างการคำนวณในส่วนนี้จะทำการวิเคราะห์ต่อยอดจากโปรแกรมคำนวณกระแสเงินสดสุทธิก่อนหน้า โดยมีการวิเคราะห์เพิ่มเติมซึ่งแสดงรายละเอียดตามตาราง

| ส่วนนำเข้า | กระบวนการ | ผลลัพธ์ |
| --- | --- | --- |
| - กระแสเงินสดสุทธิ (NetCashFlow) | - คำนวณลดทอนกระแสเงินสดสุทธิ | - มูลค่าในปัจจุบันสุทธิ (NPV) |
| - อัตราคิดลด (DiscountRate) | - คำนวณเพื่อหามูลค่าปัจจุบันสุทธิ (NPV) |  |
| - มูลค่าปัจจุบัน (PV) |  |  |
| - ระยะเวลาในการลงทุนหรือระยะเวลาโครงการ (n) |  |  |

จากตาราง แสดงการวิเคราะห์เพื่อประเมินการลงทุนด้วยมูลค่าปัจจุบันสุทธิ โดยได้กำหนดส่วนนำเข้าของกระบวนการประเมินมูลค่าปัจจุบันสุทธิ ได้แก่ กระแสเงินสดสุทธิ (NetCashFlow) อัตราคิดลด (DiscountRate) มูลค่าปัจจุบัน (PV) และระยะเวลาในการลงทุนหรือระยะเวลาโครงการ (n) โดยกำหนดส่วนผลลัพธ์ คือ มูลค่าปัจจุบันสุทธิ (NPV) หลังจากดำเนินการคิดลดทอนรายการกระแสเงินสดสุทธิทั้งหมด ซึ่งค่า NPV นี้สามารถนำไปใช้ในการพิจารณาแนะนำการลงทุน โดยเมื่อค่า NPV เป็นบวก แสดงถึงมีความเป็นไปได้ในการลงทุน โดยสามารถเขียนเป็นผังโปรแกรมได้ดังภาพ

<img src=img/0907.png>

จากภาพ แสดงผังโปรแกรมประเมินการลงทุนด้วยมูลค่าปัจจุบันสุทธิ ซึ่งมีรายละเอียดขั้นตอนวิธีการทำงาน ดังนี้
1. ประกาศตัวแปร ได้แก่ราคา (Price) เงินสดจ่ายครั้งแรก (CF_int) ค่างวด (CF_payment) ราคาขายออกที่ต้องการหลังผ่อนชำระงวดสุดท้ายเสร็จสิ้น (CF_final) อัตราดอกเบี้ยธนาคาร (rate) รายได้ที่เกิดจากการลงทุน เช่น การให้เช่าต่อ (CF_recive) ตัวแปรชั่วคราวกระแสเงินสดสุทธิ (NetCashFlaw) ตัวแปรชั่วคราวมูลค่าปัจจุบัน (PV) ตัวแปรชั่วคราวมูลค่าปัจจุบันสุทธิ (NPV)  และตัวแปรเก็บจำนวนปีที่ผ่อนชำระค่างวด (n)
2. รับค่าตัวแปรราคา (Price) กระแสเงินสดการจ่ายชำระครั้งแรกหรือเงินดาวน์ (CF_int) อัตราดอกเบี้ยธนาคาร (rate) และ จำนวนปีที่ผ่อนชำระค่างวด (n)
3. คำนวณค่างวดชำระต่อเดือนด้วยคำสั่ง CF_payment = getCF_payment(Price, CF_int, rate, n)
4. รับค่าตัวแปรรายได้ที่เกิดจากการลงทุน (CF_recive) และราคาขายออกที่ต้องการหลังผ่อนชำระงวดสุดท้ายเสร็จสิ้น (CF_final)
5. คำนวนหารายการ (Statement) ในปีที่ 0 (เริ่มลงทุน) ประกอบด้วย กระแสเงินสดสุทธิ (NetCashFlow) อัตราลดทอน (DiscountRate) มูลค่าปัจจุบัน (PV) และมูลค่าปัจจุบันสุทธิ (NPV)
6. แสดงรายการ (Statement) ในปีที่ 0 (เริ่มลงทุน) ประกอบด้วย ปีที่ กระแสเงินสดสุทธิ (NetCashFlow) อัตราลดทอน (DiscountRate) มูลค่าปัจจุบัน (PV) และ มูลค่าปัจจุบันสุทธิ (NPV)
7. วนรอบจำนวนปีที่ผ่อนค่างวดเริ่มตั้งแต่ปีที่ i = 1 ถึงปีที่ i = n

      7.1 ถ้ายังไม่ครบ n ปี

    (1) คำนวนหารายการ (Statement) ในปีที่ i (เริ่มลงทุน) ประกอบด้วย กระแสเงินสดสุทธิ (NetCashFlow) อัตราลดทอน (DiscountRate) มูลค่าปัจจุบัน (PV) และ มูลค่าปัจจุบันสุทธิ (NPV)

    (2) แสดงรายการ (Statement) ในปีที่ i (เริ่มลงทุน) ประกอบด้วย ปีที่ กระแสเงินสดสุทธิ (NetCashFlow) อัตราลดทอน (DiscountRate) มูลค่าปัจจุบัน (PV) และ มูลค่าปัจจุบันสุทธิ (NPV)

      7.2 ถ้าครบปีททที่ n จบการวนรอบ
  
8.  คำนวนหารายการ (Statement) ในปีที่ n+1 (ขายออก) ประกอบด้วย กระแสเงินสดสุทธิ (NetCashFlow) อัตราลดทอน (DiscountRate) มูลค่าปัจจุบัน (PV) และ มูลค่าปัจจุบันสุทธิ (NPV)
9.  แสดงรายการ (Statement) ในปีที่ n+1 (ขายออก) ประกอบด้วย ปีที่ n+1 กระแสเงินสดสุทธิ (NetCashFlow) อัตราลดทอน (DiscountRate) มูลค่าปัจจุบัน (PV) และ มูลค่าปัจจุบันสุทธิ (NPV)

จากขั้นตอนวิธีข้างต้น สามารถนำไปเขียนโปรแกรมด้วยภาษาซีพลัสพลัสได้ ดังนี้

```
#include <stdio.h>
#include <conio.h>
#include <math.h>
float getCF_payment(float Price, float CF_int, float rate, int n);
main() {
    float Price, CF_int, CF_payment, CF_final, rate, CF_recive;
    float NetCashFlow, DiscountRate, PV, NPV;
    int n;
    printf("Net Present Value Calculator\n");
    printf("Input Net Price:"); scanf("%f", &Price);
    printf("An initial payment (BAHT):"); scanf("%f", &CF_int);
    printf("Take out a loan (BAHT): %.0fB\n", (Price-CF_int));
    printf("Input Interest Rate (percent):"); scanf("%f", &rate);
    printf("Input number of year for payment:"); scanf("%d", &n);
    CF_payment = getCF_payment(Price, CF_int, rate, n);
    printf("Monthly Payment (BAHT): %.4f\n", CF_payment);
    printf("Input Interest Income for Receive per Month (BAHT):"); 
    scanf("%f", &CF_recive);
    printf("Input Interest Net Price for Sell after Final Payment (BAHT):"); 
    scanf("%f", &CF_final);
    printf("STATEMENT\n");
    DiscountRate = 1.0000;
    NetCashFlow = -CF_int;
    PV = NetCashFlow / DiscountRate;
    NPV = PV;
    printf("%5s %20s %20s %20s %20s\n", "Year", "Net Cash Flow", 
            "Discount Rate", "Present Value", "Net Present Value");
    printf("%5d %20.4fB %20.4fB %20.4fB %20.4fB\n", 0, -CF_int, 
             1.0000, -CF_int, NPV);
    for(int i = 1; i<=n; i++) {
        DiscountRate = pow((1+(rate/100.00)), i);
        NetCashFlow = (CF_recive*12-CF_payment*12);
        PV = NetCashFlow / DiscountRate;
        NPV = NPV + PV;
         printf("%5d %20.4fB %20.4fB %20.4fB %20.4fB\n", i, 
                  NetCashFlow, DiscountRate, PV, NPV);
    }
    DiscountRate = pow((1+(rate/100.00)), n+1);
    NetCashFlow = CF_final;
    PV = NetCashFlow / DiscountRate;
    NPV = NPV + PV;
    printf("%5d %20.4fB %20.4fB %20.4fB %20.4fB\n", n+1, 
            NetCashFlow, DiscountRate, PV, NPV);
}
float getCF_payment(float Price, float CF_int, float rate, int n) {
    return ((Price-CF_int)+(((Price-CF_int)*(rate/100))*n))/(n*12);
}
```
[ดาวน์โหลด source code](src/ch09_07.cpp)

ด้วยรายการกระแสเงินสดสุทธิ (Net Cash Flow) เป็นข้อมูลนำเข้าที่จะนำไปใช้ในกระบวนการคำนวณหามูลค่าปัจจุบันสุทธิ (Net Present Value) ดังนั้น จะใช้ข้อมูลนำเข้าจากชุดข้อมูลเดียวกับ[โปรแกรมคำนวณกระแสเงินสดสุทธิ](src/ch09_06.cpp)ก่อนหน้า เพื่อคำนวณค่าต่าง ๆ  และทดสอบโปรแกรม ดังนี้ “ต้องการจะลงทุนซื้ออาคารพาณิชย์ในราคา 1,800,000 บาท โดยมีเงินสดลงทุนจำนวน 1,000,000 บาทและส่วนที่เหลือจะผ่อนธนาคาร โดยอัตราดอกเบี้ยเงินกู้ที่ต้องการอยู่ที่ 6% ต่อปี ใช้ระยะเวลาผ่อนชำระจำนวน 5 ปี ระหว่างการผ่อนชำระจะปล่อยให้เช่าเดือนละ 20,000 บาท โดยเมื่อผ่อนชำระงวดสุดท้ายเสร็จสิ้นจะทำการขายออกในราคา 2,000,000 บาท” ซึ่งผลลัพธ์การทำงานของโปรแกรมปรากฏบนจอภาพ ดังนี้

```
Net Present Value Calculator
Input Net Price:1800000
An initial payment (BAHT):1000000
Take out a loan (BAHT):800000B
Input Interest Rate (percent):6
Input number of year for payment:5
Monthly Payment (BAHT): 17333.3340
Input Interest Income for Receive per Month (BAHT):20000
Input Interest Net Price for Sell after Final Payment (BAHT):2000000
STATEMENT
 Year      Net Cash Flow Discount Rate       Present Value       Net Present Value
    0   -1000000.0000B          1.0000B      -1000000.0000B      -1000000.0000B
    1        31999.9922B        1.0600B         30188.6738B       -969811.3125B
    2        31999.9922B        1.1236B         28479.8789B       -941331.4375B
    3        31999.9922B        1.1910B          26867.8105B      -914463.6250B
    4        31999.9922B        1.2625B         25346.9922B      -889116.6250B
    5        31999.9922B        1.3382B         23912.2559B      -865204.3750B
    6     2000000.0000B         1.4185B       1409921.0000B        544716.6250B
```

จากผลลัพธ์ข้างต้น โปรแกรมได้แสดงข้อมูลออกเป็น 5 ส่วน ได้แก่ ปีที่ลงทุน (Year) กระแสเงินสดสุทธิ (Net Cash Flow) อัตราการลดทอน (Discount Rate) มูลค่าปัจจุบันที่ลดทอน (Present Value) และ มูลค่าปัจจุบันสุทธิ (Net Present Value) โดยหากพิจารณามูลค่าปัจจุบันสุทธิ (Net Present Value) ในปีสุดท้าย พบว่ามีค่า 544,716.6250 บาท และเป็นค่าบวกซึ่งแสดงถึงความเป็นไปได้ในการลงทุน

---
#### [<< หน้าก่อนหน้า](0903-6.md) | [หน้าเลือกหัวข้อ](README.md) | [หน้าต่อไป >>](0903-8.md)
---
