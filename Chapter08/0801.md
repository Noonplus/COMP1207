## พอยน์เตอร์
 	
พอยน์เตอร์ (Pointer) เป็นตัวแปรที่ทำหน้าที่เก็บตำแหน่งที่อยู่ (Address) ของตัวแปรอื่นที่อยู่ในหน่วยความจำ ซึ่งแตกต่างจากตัวแปรประเภทอื่นที่ใช้ในการเก็บข้อมูล ข้อดีของการใช้ตัวแปรพอยน์เตอร คือ จะช่วยลดปริมาณหน่วยความจำที่ต้องใช้ในการเขียนโปรแกรม โดยเฉพาะเมื่อมีการเรียกใช้ข้อมูลจากหลาย ๆ ฟังก์ชันพร้อมกัน การใช้งานพอยน์เตอร์เป็นคุณสมบัติเด่นของภาษาซี ดังนั้นในหัวข้อนี้จะอธิบายรูปแบบการประกาศพอยน์เตอร์การอ้างอิงข้อมูลจากพอยน์เตอร์และ วิธีการใช้งาน โดยมีรายละเอียดดังนี้

### รูปแบบการประกาศพอยน์เตอร์
การประกาศพอยน์เตอร์มีรูปแบบคล้ายกับการประกาศใช้งานตัวแปรทั่วไป โดยจะเริ่มจากการประกาศประเภทตัวแปรพอยน์เตอร์เพื่อบอกถึงหน่วยความจำที่เก็บข้อมูลที่พอยน์เตอร์จะชี้ ซึ่งรูปแบบคำสั่ง มีดังนี้

```
ชนิดข้อมูล *ชื่อพอยน์เตอร์;
```

โดยที่ ชนิดข้อมูล หมายถึง การระบุชนิดข้อมูลที่ต้องการให้พอยน์เตอร์ชี้ไป เช่น จำนวนเต็ม (int) เป็นต้น ส่วน สัญลักษณ์ ```“*”``` เป็นสัญลักษณ์เพื่อบอกให้ทราบว่าตัวแปรที่ประกาศไม่ใช้ตัวแปรในรูปแบบปกติแต่เป็นพอยน์เตอร์ และ ชื่อพอยน์เตอร์ เป็นการระบุชื่อตัวแปรตามหลักการตั้งชื่อตัวแปร การประกาศใช้งานพอยน์เตอร์จะระบุสัญลักษณ์ “*” ไว้ด้านหน้าเพื่อแสดงให้เห็นว่าตัวแปรดังกล่าวเป็นชนิดพอยน์เตอร์ซึ่งจะทำหน้าที่สำหรับการอ้างอิงตำแหน่งในหน่วยความจำ ซึ่งในการอ้างอิงตำแหน่งของตัวแปรนั้น พอยน์เตอร์ที่จะไปใช้อ้างอิงจะต้องมีชนิดข้อมูลแบบเดียวกันกับตัวแปรนั้น โดยตัวอย่างการประกาศพอยน์เตอร์ เช่น

```
01:int *p;                // ประกาศพอยน์เตอร์p
02:int *p, *q;          // ประกาศพอยน์เตอร์p กับ q
03:int x = 10;          // ประกาศตัวแปร x = 10
04:p = &x;             // พอยน์เตอร์ p ชี้ไปยังตำแหน่งของตัวแปร x
05:q = p;               // พอยน์เตอร์ q ชี้ไปยังตำแหน่งเดียวกับที่พอยน์เตอร์p ชี้อยู่
```

จากตัวอย่าง คำสั่ง ```p = &x;``` หมายถึง พอยน์เตอร์ p ชี้ไปยังตำแหน่งของตัวแปร x โดยที่เครื่องหมาย ```“&”``` หน้าตัวแปร x ระบุถึงตำแหน่งของตัวแปร x ที่ถูกจัดสรรบนหน่วยความจำ   ส่วนคำสั่ง ```q = p;``` หมายถึง พอยน์เตอร์ q ชี้ไปยังตำแหน่งเดียวกับที่พอยน์เตอร์ p ชี้อยู่ แสดงดังภาพ

<img src=img/0801.png>

### การอ้างอิงข้อมูลผ่านพอยน์เตอร์
พอยน์เตอร์มีสถานะเป็นตัวชี้ที่จัดเก็บข้อมูลตำแหน่งบนหน่วยความจำ ดังนั้นการแทนค่าให้กับพอยน์เตอร์ต้องระบุค่าด้วยตำแหน่งของตัวแปรเท่านั้น อาทิ ```p = &x;``` ส่วนการอ้างอิงค่าที่พอยน์เตอร์ชี้อยู่จะอ้างอิงด้วย ```*p``` แสดงตัวอย่าง ดังโปรแกรม

```
01:#include <stdio.h>
02:main() {
03:   int *p, x = 10;       // ประกาศพอยน์เตอร์ p และ ตัวแปร x = 10
04:   p = &x;               // พอยน์เตอร์p ชี้ไปยังตำแหน่ง x
05:   printf("%d\n", x);    // แสดงค่า x
06:   printf("%d\n", *p);   // แสดงค่าที่พอยน์เตอร์ p ชี้อยู่
07:   printf("%d\n", &x);   // แสดงตำแหน่ง x
08:   printf("%d", p);      // แสดงค่าพอยน์เตอร์ p
09:}
```
[ดาวน์โหลด source code](src/ch08_01.cpp)

จากโปรแกรมบรรทัดที่ 04 คำสั่ง ```p = &x;``` เป็นคำสั่งระบุให้พอยน์เตอร์ p ชี้ไปยังตำแหน่งของตัวแปร x ที่ถูกจัดสรรบนหน่วยความจำ ซึ่งคอมพิวเตอร์แต่ละเครื่องอาจจะได้ค่าตำแหน่งที่แตกต่างกันไปตามพื้นที่ที่ถูกจัดสรรให้กับตัวแปร x จากโปรแกรมแสดงให้เห็นความแตกต่างของการอ้างอิงค่าตัวแปรทางตรง การอ้างอิงค่าตัวแปรผ่านพอยน์เตอร์ การอ้างอิงตำแหน่งของตัวแปรทั่วไป และการอ้างอิงค่าพอยน์เตอร์ตามลำดับ ซึ่งจากโปรแกรมตัวอย่าง ได้ผลลัพธ์ ดังนี้

```
01:10
02:10
03:6356744
04:6356744	
```
หมายเหตุ: ค่า 6356744 คือ ค่าตำแหน่งในหน่วยความจำที่ถูกจัดสรรให้กับตัวแปร x

### การใช้งานพอยน์เตอร์เบื้องต้น
การประยุกต์ใช้งานพอยน์เตอร์สามารถใช้งานกับตัวแปรเชิงโครงสร้างได้หลายลักษณะ เช่น การใช้งานกับตัวแปรข้อความ การใช้งานกับตัวแปรแบบอาเรย์ เป็นต้น ซึ่งการประยุกต์ใช้งานพอยน์เตอร์ตามลักษณะตัวแปร มีรายละเอียดดังนี้
#### 1. พอยน์เตอร์กับตัวแปรข้อความ
ตัวแปรข้อความที่จัดเก็บในหน่วยความจำเป็นการนำอักขระมาเรียงต่อกันจนสิ้นสุดข้อความและจะใช้อักขระว่างปิดท้าย ซึ่งอักขระว่างดังกล่าวใช้สำหรับการตรวจสอบตำแหน่งสิ้นสุดของข้อความ ในภาษาซีแทนค่าว่าง (NULL) หรือ แทนด้วยค่า ‘\0’ การเข้าถึงอักขระดังกล่าวสามารถที่จะเข้าถึงแต่ละตัวอักษรด้วยการอ้างอิงแบบอาเรย์ หรือการอ้างอิงผ่านการประกาศตัวแปรพอยน์เตอร์ที่อยู่ในรูปพอยน์เตอร์ข้อความ ดังตัวอย่าง

```
01:char *name = "Natasha Romanoff";   // ประกาศตัวแปรข้อความเป็นรูปพอยน์เตอร์
```

จากตัวอย่างข้างต้น พอยน์เตอร์ชนิดอักขระถูกประกาศขึ้นและแทนค่าด้วยข้อความว่า "Natasha Romanoff" อักขระตัวแรกของข้อความจะถูกเขียนลงไปในหน่วยความจำ โดยมีพอยน์เตอร์ name อ้างอิงในตำแหน่งแรกของตัวอักษร และมีอักขระที่เหลือเรียงต่อกันไปตามลำดับ สุดท้ายก็จะปิดท้ายด้วยอักขระว่าง คือ ‘\0’ ซึ่งการจัดสรรจำนวนพื้นที่สำหรับจัดเก็บข้อความทั้งหมด จำนวน 17 ตัวอักษร หรือ 17 ไบต์ และการอ้างอิงค่าผ่านพอยน์เตอร์อักขระดังกล่าวจะสามารถอ้างอิงได้ครั้งละ 1 ตัวอักษรโดยเริ่มจากตำแหน่งแรกของตัวอักษรที่พอยน์เตอร์ชี้อยู่ แสดงตามภาพ

<img src=img/0802.png>

จากภาพแสดงให้เห็นว่าหากต้องการเข้าถึงข้อความที่ระบุค่าไว้โดยการอ้างอิงพอยน์เตอร์สามารถเข้าถึงได้ครั้งละ 1 ตัวอักษร โดยใช้วิธีขยับตำแหน่งอ้างอิงของพอยน์เตอร์ไปครั้งละ 1 ตำแหน่ง (1 ไบต์) จนกระทั่งพบค่าว่าง ‘\0’ ซึ่งตัวอย่างโปรแกรมการประยุกต์ใช้พอยน์เตอร์กับตัวแปรข้อความ แสดงดังโปรแกรม

```
01:#include <iostream>
02:#include <windows.h>     // เพื่อใช้คำสั่งหยุดพัก Sleep()
03:using namespace std;  
04:int main() {
05:   char *name = "Natasha Romanoff";  // ประกาศพอยน์เตอร์ name 
06:   cout << name << endl;             // แสดงข้อความ name
07:   do {                      // วนรอบ 17 ครั้ง
08:       Sleep(100);                   // หยุดพัก 100 มิลลิวินาที
09:       cout << *name++;              // แสดงอักขระที่ตำแหน่ง name++
10:   } while(*name != '\0');   // วนรอบจนกระทั่งอักขระ คือ ‘\0’
11:   return 0;
12:}
```
หมายเหตุ: บรรทัดที่ 02: ไลบรารี windows.h ถูกเรียกใช้เพื่อใช้งานคำสั่ง Sleep()
[ดาวน์โหลด source code](src/ch08_02.cpp)

จากโปรแกรม บรรทัดที่ 08 คำสั่ง Sleep(100); เป็นการสั่งให้โปรแกรมหยุดพัก 100 มิลลิวินาที ส่วนคำสั่งในบรรทัดที่ 09 ```count << *name++;``` เป็นการแสดงค่า ณ ตำแหน่งถัดไป 1 ไบต์ และคำสั่งบรรทัดที่ 10 ค่า ‘\0’ คือ ค่าว่าง หรือสามารถอ้างอิงด้วยค่า NULL ก็ได้ และจากโปรแกรมได้ผลลัพธ์ปรากฏบนจอภาพ ดังนี้

```
01:Natasha Romanoff
02:Natasha Romanoff	
```

จากผลลัพธ์ การแสดงข้อความ “Natasha Romanoff” ในแถวที่ 02 จะแสดงทีละ 1 ตัวอักษร โดยมีการหยุดพัก 100 มิลลิวินาทีก่อนจะแสดงตัวอักษรลำดับถัดไปจนครบ

#### 2.  พอยน์เตอร์กับอาเรย์
อาเรย์เป็นตัวแปรโครงสร้างแบบอ้างอิงที่มีลำดับการจัดเก็บข้อมูลบนหน่วยความจำติดต่อกัน ซึ่งจะคล้ายกับตัวแปรข้อความ ดังนั้น การใช้พอยน์เตอร์อ้างอิงข้อมูลแบบอาเรย์จะต้องเริ่มต้นด้วยการกำหนดให้พอยน์เตอร์ชี้ไปยังตำแหน่งของสมาชิกตัวแรก เช่น

```
01:int x[10],              // ประกาศตัวแปรอาเรย์ x
02:int *p;                // ประกาศพอยน์เตอร์ p
03:p =  &x[0];          // กำหนดให้พอยน์เตอร์ p ชี้ไปยังตำแหน่งของสมาชิกตัวแรกของ x
```
หมายเหตุ: พอยน์เตอร์ที่ใช้อ้างอิงค่าตัวแปรต้องมีชนิดเดียวกับตัวแปรที่อ้างอิง

จากตัวอย่างข้างต้น แสดงวิธีการอ้างอิงของพอยน์เตอร์บนหน่วยความจำ ซึ่งสามารถเขียนออกมาดังภาพ

<img src=img/0803.png>

จากภาพ ตัวแปร x เป็นข้อมูลที่มีโครงสร้างแบบอาเรย์ โดยสมาชิกเป็นชนิดจำนวนเต็ม (ชนิด int มีขนาด 2 ไบต์) จำนวนทั้งสิ้น 10 ค่า ส่วนพอยน์เตอร์ p ที่ใช้ถูกกำหนดให้ชี้ไปยังอาเรย์ ณ ตำแหน่งของสมาชิกแรกของอาเรย์ คือ ```x[0]``` ตามโครงสร้างอาเรย์และการอ้างอิงข้อมูลของพอยน์เตอร์หากต้องการเข้าถึงสมาชิกของอาเรย์แต่ละตัวผ่านพอยน์เตอร์ดังกล่าว สามารถทำได้โดยการขยับตำแหน่งจนกระทั่งถึงสมาชิกลำดับสุดท้าย ดังแสดงตัวอย่างในโปรแกรม

```
01:#include <iostream>
02:using namespace std;
03:main() {
04:   int x[10] = {0,1,2,3,4,5,6,7,8,9}, *p;
05:   p = &x[0];
06:   for(int i=0; i < sizeof(x)/sizeof(*p); i++) { // วนจำนวน 10 รอบ
07:       cout << "Array[" << i << "]: " << *p++ << endl;
08:   }
09:}
```
[ดาวน์โหลด source code](src/ch08_03.cpp)

จากโปรแกรม คำสั่งในบรรทัดที่ 06 ```sizeof(x)/sizeof(*p)``` เป็นการคำนวนจำนวนสมาชิกของอาเรย์ โดยที่ ```sizeof(x)``` คือ ขนาดของอาเรย์ ที่มีขนาดเท่ากับ 20 ไบต์ ส่วน ```sizeof(*p)``` คือ ขนาดของการอ้างอิงพอยน์เตอร์ p มีขนาดเท่ากับ 2 ไบต์ ดังนั้น ```sizeof(x)/sizeof(*p)``` มีค่าเท่ากับ 10 ได้ผลลัพธ์ปรากฏบนจอภาพ ดังนี้

```
01:Array[0]: 0
02:Array[1]: 1
03:Array[2]: 2
04:Array[3]: 3
05:Array[4]: 4
06:Array[5]: 5
07:Array[6]: 6
08:Array[7]: 7
09:Array[8]: 8
10:Array[9]: 9
11:	
```

---
#### [หน้าเลือกหัวข้อ](README.md) | [หน้าต่อไป >>](0802.md)
---
